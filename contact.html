<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://kit.fontawesome.com/caa13318f3.js" crossorigin="anonymous"></script>
    <link rel="shortcut icon" href="./images/vs-favicons.png" type="image/x-icon">
    <link rel="stylesheet" href="./css/mediaQuery.css">
    <title>Contact Us | DevTube | Vesus Studio</title>
</head>

<body>
    <div class="overflow-stop">
        <div class="ppop">
            <div class="popup" id="popup">
                <div class="message">
                    <p id="msgText">
                        Sorry to say that, but we are currently under development. Please come back later!
                    </p>
                    <i class="far fa-times-circle closePopup" id="close-btn"></i>
                </div>
            </div>
        </div>
        <header>
            <nav>
                <div class="logo-img">
                    <a href="index.html"><img src="./images/logo.png" alt="Vesus Studio Logo" /></a>
                </div>
                <input type="checkbox" id="click">
                <label for="click" class="menu-bar">
                    <i class="fa-solid fa-bars-staggered" id="navBtn"></i>
                </label>
                <ul id="sideMenu">
                    <li><a href="index.html#home"><i class="fas fa-house"></i> Home</a></li>
                    <li><a href="index.html#content"><i class="fas fa-file-video"></i> Content</a></li>
                    <li><a href="contact.html"><i class="fas fa-address-book"></i> Contact</a></li>
                    <li><a href="about.html"><i class="fas fa-address-card"></i> About</a>
                    </li>
                </ul>
            </nav>
        </header>
        <main>
            <section class="contact-container">
                <!-- <span class="alertMsg" id="msg">Sorry :), currently this form will not submit any enquiries.</span> -->
                <span id="msg"></span>
                <form action="#" method="post" id="contactForm" class="contactForm">
                    <h1>Contact Us</h1>
                    <div class="row">
                        <div class="input-fields">
                            <input type="datetime-local" name="timestamps" id="timestamp" title="Enter your timestamp" required>
                            <label for="timestamp">Timestamp</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-fields">
                            <input type="text" name="firstName" id="fname" title="Enter your first name" required>
                            <label for="fname">First Name</label>
                        </div>
                        <div class="input-fields">
                            <input type="text" name="lastName" id="lname" title="Enter your last name" required>
                            <label for="lname">Last Name</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-fields">
                            <input type="email" name="email" id="email" title="Enter your email" required>
                            <label for="email">Email</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-fields">
                            <textarea name="message" id="messages" title="Enter your message" cols="30" rows="5"
                                required></textarea>
                            <label for="messages">Message</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-fields">
                            <button type="submit" name="submit" id="submitBtn">Submit</button>
                        </div>
                    </div>
                </form>
            </section>
        </main>
        <footer id="contact">
            <div class="social-links">
                <h3>Social Media:</h3>
                <a class="github" href="https://github.com/versus-studio" target="_blank"><i class="fab fa-github"></i>
                    Github</a>
                <a class="instagram" href="https://www.instagram.com/versus_studio.vs" target="_blank"><i
                        class="fab fa-instagram"></i> Instagram</a>
            </div>
            <div class="copyright">
                <p>
                    All copyrights are reserved by Versus-Studio
                </p>
            </div>
        </footer>
    </div>
    <script src="./js/script.js"></script>
    <script src="./js/videosShow.js"></script>
    <script>

        // Contact Page Data Transferring to Google Sheets
        document.addEventListener("DOMContentLoaded", () => {
            function getFormattedDateTime() {
                const now = new Date();
                const year = now.getFullYear();
                const month = ('0' + (now.getMonth() + 1)).slice(-2);
                const day = ('0' + now.getDate()).slice(-2);
                const hours = ('0' + now.getHours()).slice(-2);
                const minutes = ('0' + now.getMinutes()).slice(-2);
                return `${year}-${month}-${day}T${hours}:${minutes}`;
            }

            
            const url = "https://script.google.com/macros/s/AKfycbxODhnt7beD9gRfLtgHHLNaPRSgcBe1oAjsTuCWj-O0xoDVi6C0OuyS6tWXjv8TvUEBGw/exec";
            
            const timestamp = document.getElementById("timestamp");
            const submitBtn = document.getElementById("submitBtn");
            const msg = document.getElementById("msg");
            const forms = document.getElementById("contactForm");
            
            timestamp.value = getFormattedDateTime();
            setInterval(() => {
                timestamp.value = getFormattedDateTime();
            }, 60000);
            
            forms.addEventListener("submit", (e) => {
                e.preventDefault();
                submitBtn.innerHTML = "Submitting...";
                timestamp.values = getFormattedDateTime();
                const formData = new FormData(forms);
                fetch(url, {
                    method: "POST",
                    body: formData,
                })
                    .then((res) => res.text())
                    .then((finalres) => {
                        submitBtn.innerText = "Submit";
                        msg.classList.remove('alertMsg');
                        msg.classList.add('popupGreen');
                        msg.innerText = finalres;
                        forms.querySelectorAll("input, textarea").forEach((input) => {
                            if (input.type !== 'datetime-local') {
                                input.value = "";
                            }
                        });
                        setTimeout(() => {
                            msg.innerText = "";
                            msg.classList.remove('popupGreen');
                        }, 5000);
                    })
                    .catch((error) => {
                        console.error('Error:', error);
                        submitBtn.innerText = "Submit";
                        msg.classList.add('alertMsg');
                        msg.innerText = "Failed to send data. Please try again.";
                    });
            });
        })

    </script>
</body>

</html>